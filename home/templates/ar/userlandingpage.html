<!---extand basic django-->
{% extends 'ar/base2.html' %}
<!---import static django-->
{% load static %}
<!---block django-->
{% block body %}


<style>

    .imagescale {
        scale: 0.8;
        transition: scale 0.3s ease-in-out; /* Adjust the duration and timing function as needed */
    }

    .imagescale:hover {
        scale: 1;
    }

    .show:hover{
        cursor: pointer;
        color:#00D094;
    }

    .secured-video-wrapper {
        position: relative;
    }

    .secured-video {
        width: 100%;
        height: 100%;
        -webkit-user-select: none;
        user-select: none;
        background-color: #000;
    }

    .video-overlay {
        position: absolute;
        inset: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        background: rgba(0, 0, 0, 0.75);
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.3s ease;
        z-index: 5;
    }

    .video-overlay.is-visible {
        opacity: 1;
        pointer-events: auto;
    }

    .video-overlay .trk-btn {
        padding: 0.75rem 2.5rem;
        font-size: 1.125rem;
    }

    .trk-btn.is-locked {
        opacity: 0.6;
        cursor: not-allowed;
    }

    .video-security-toast {
        position: fixed;
        left: 50%;
        bottom: 2rem;
        transform: translate(-50%, 2rem);
        background: rgba(0, 0, 0, 0.85);
        color: #ffffff;
        padding: 0.75rem 1.75rem;
        border-radius: 999px;
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.3s ease, transform 0.3s ease;
        z-index: 1050;
        max-width: 90%;
        text-align: center;
        font-size: 1rem;
    }

    .video-security-toast.show {
        opacity: 1;
        transform: translate(-50%, 0);
    }

    .user-landing-page {
        overflow-x: hidden;
    }

    .user-landing-page .banner__thumb img {
        width: 100%;
        height: auto;
        display: block;
    }

    .user-landing-page .secured-video-wrapper,
    .user-landing-page .secured-video {
        border-radius: 1rem;
    }

    .user-landing-page #request {
        padding-inline: 0;
    }

    .user-landing-page .title p {
        margin-bottom: 0;
    }

    @media (max-width: 991.98px) {
        .user-landing-page .banner__wrapper {
            text-align: center;
        }

        .user-landing-page .banner__content {
            align-items: center;
        }

        .user-landing-page .banner__content-heading {
            font-size: 2rem;
            line-height: 1.3;
        }

        .user-landing-page .banner__content-moto {
            font-size: 1rem;
        }

        .user-landing-page .banner__thumb {
            margin-inline: auto;
            max-width: 420px;
        }

        .user-landing-page #videosection .container {
            padding-inline: 1rem;
        }

        .user-landing-page .secured-video-wrapper {
            margin-inline: auto;
        }

        .user-landing-page #request {
            padding-inline: 1rem;
        }

        .user-landing-page #request .col-md-6 {
            flex: 0 0 100%;
            max-width: 100%;
        }

        .user-landing-page #request .form-label {
            font-size: 0.95rem;
        }
    }

    @media (max-width: 575.98px) {
        .user-landing-page .banner__wrapper {
            gap: 1.5rem;
        }

        .user-landing-page .banner__content-heading {
            font-size: 1.75rem;
        }

        .user-landing-page #videosection h1 {
            font-size: 1.75rem;
        }

        .user-landing-page #toggleButton {
            font-size: 1.25rem;
        }

        .user-landing-page .show i {
            font-size: 1rem;
        }

        .user-landing-page .title p {
            font-size: 1.5rem !important;
            line-height: 1.5;
        }

        .user-landing-page .secured-video-wrapper,
        .user-landing-page .secured-video {
            border-radius: 0.75rem;
        }
    }
</style>



<!DOCTYPE html>
<html lang="en">
<head>
    <title>Trading Whale School </title>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Sites meta Data -->
  <meta name="application-name" content="Trading Whale School">
  <meta name="author" content="Your Name">
  <meta name="keywords" content="Trading Whale School, Trading Education, Trading Monster">
  <meta name="description" content="Trading Whale School is your go-to platform for learning how to trade and become a trading monster.">

  <!-- OG meta data -->
  <meta property="og:title" content="Trading Whale School">
  <meta property="og:description" content="Trading Whale School is your go-to platform for learning how to trade and become a trading monster.">
  <meta property="og:image" content="{% static 'assets/images/logo/login-logo.png' %}">
  



  <link rel="shortcut icon" href="{% static 'assets/images/logo/logo.png' %}" type="image/x-icon">
  <link rel="stylesheet" href="{% static 'assets/css/bootstrap.min.css' %}">
  <link rel="stylesheet" href="{% static 'assets/css/aos.css' %}">
  <link rel="stylesheet" href="{% static 'assets/css/all.min.css' %}">

  <link rel="stylesheet" href="{% static 'assets/css/swiper-bundle.min.css' %}">



  <!-- main css for template -->
  <link rel="stylesheet" href="{% static 'assets/css/style.css' %}">
</head>
<body class="user-landing-page">

    <header class="header-section header-section--style1" style="display: none;">
        <div class="header-bottom">
          <div style="">
            <div class="header-wrapper" style="justify-content: space-evenly;display: flex;">
              <div class="logo">
                <a href="#">
                  <img class="" style="width:130px;" src="{% static 'assets/images/logo/preloader.png' %}" alt="logo">
                </a>
              </div>
              <div class="menu-area">
                <ul class="menu">
                  <li>
                    <a href="#homepage" class="menu-li-a">الصفحة الرئيسية </a>
                  </li>
                  <li>
                    <a href="#videosection" class="menu-li-a">الفيديوا </a>
                  </li>
                  <li>
                    <a href="#request" id="showModalx" class="menu-li-a"> طلب العضوية </a>
                  </li>
                  
    
                  
    
                </ul>
    
              </div>
    
              <div class=" d-flex" style="align-items:center;">
                
                <ul style="display: flex;">
                  <li style="display: flex;margin-top: -15px;">
                    <div class="header-action">
                      <div class="menu-area">
                        
                        <div class="" style="display: flex;">
                          <a href="{% url 'accounts:login_ar' %}" class="trk-btn trk-btn--border trk-btn--primary">
                            <span>تسجيل دخول</span>
                          </a>
                        </div>
                      </div>
                    </div>
                  </li>
                  <li style="display: flex; margin-right: 20px;">
                    <i class="fa fa-language" style="color:#e5cd26;font-size: 25px;"></i>
                    <div class="custom-dropdown" >
                      <button class="" style="background-color: #00150f; border: none;">
                          <a href="/landingpage/">English</a> 
                      </button>
                    </div>
                  </li>
                </ul>
                
                <!---language icon-->
                
              </div>
    
                <!-- toggle icons -->
                <div class="header-bar d-lg-none header-bar--style1">
                  <span></span>
                  <span></span>
                  <span></span>
                </div>
             
            </div>
          </div>
        </div>
      </header>



      <section class="banner banner--style3"  id="homepage">
        <div class="banner__bg">
          <div class="banner__bg-element">
            <img src="{% static 'assets/images/bg.png' %}" alt="section-bg-element" class="dark d-none d-lg-block">
            <span class="bg-color d-lg-none"></span>
          </div>
        </div>
        <div class="container">
          <div class="banner__wrapper">
            <div class="row gy-5 gx-4">
              <div class="col-lg-6 col-md-7" style="display: flex; align-items: center;">
                <div class="banner__content" data-aos="fade-right" data-aos-duration="1000">
                  
                  <h2 class="banner__content-heading"> <span>{{ landing_page.title_ar }}</span></h2>
                  <p class="banner__content-moto text-white lead">
                    {{ landing_page.description_ar }}
                </p>
                </div>
              </div>
              <div class="col-lg-6 col-md-5">
                <div class="banner__thumb imagescale" data-aos="fade-left" data-aos-duration="1000">
                  {% if landing_page.image %}
                  <img src="{{ landing_page.image.url }}" alt="صورة تعريفية">
                  {% else %}
                  <img src="{% static 'assets/images/logo/preloader.png' %}" alt="صورة تعريفية">
                  {% endif %}
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="banner__shape">
          <span class="banner__shape-item banner__shape-item--1"><img src="{% static 'assets/images/banner/home1/4.png' %}"
              alt="shape icon"></span>
        </div>
      </section>




      <div class="container-fluid py-5" style="background-color: #0C201D;" id="videosection">
        <div class="container">
          <h1 class="text-center" style="color: #00D094;">محاضرة التداول</h1>
      
          <div class="secured-video-wrapper">
            <video
              id="promoVideo"
              class="secured-video"
              {% if landing_page.video %}data-video-src="{{ landing_page.video.url }}"{% endif %}
              data-progress-key="landing-{{ landing_page.pk }}-ar"
              data-security-message="لأسباب أمنية لا يسمح بتنزيل أو تصوير هذا الفيديو."
              {% if landing_page.video_poster %}poster="{{ landing_page.video_poster.url }}"{% endif %}
              controls
              playsinline
              preload="metadata"
              controlsList="nodownload noplaybackrate noremoteplayback"
              disablePictureInPicture
              oncontextmenu="return false;"
              width="100%"
              height="100%"
            ></video>
            <div class="video-overlay" id="videoOverlay">
              <button type="button" class="trk-btn trk-btn--primary" id="videoOverlayPlay">ابدأ الفيديو</button>
            </div>
          </div>
            {% if not landing_page.video %}
            <div class="alert alert-warning text-center mt-3" role="alert">
              لا يوجد فيديو متاح حاليًا.
            </div>
            {% endif %}
          </div>
      
          <div class="title">
            <p class="lead text-center mt-5" style="font-size: 46px; color: red;">
              {{ video.message_ar }}
            </p>
          </div>
        </div>
      </div>
      
      <script>
        const video = document.getElementById('promoVideo');
        if (video && video.getAttribute('src')) {
          let lastAllowedTime = 0;
          let seekingBlocked = false;

          // Try autoplay with sound (may fail silently)
          video.play().catch(() => {
            // Wait for user interaction to play with sound
            document.body.addEventListener('click', () => {
              video.muted = false;
              video.play();
            }, { once: true }); // only once is enough
          });

          // Track last allowed playback time
          video.addEventListener('timeupdate', () => {
            if (!seekingBlocked) {
              lastAllowedTime = video.currentTime;
            }
          });

          // Prevent seeking forward
          video.addEventListener('seeking', () => {
            if (video.currentTime > lastAllowedTime + 0.01) {
              seekingBlocked = true;
              video.currentTime = lastAllowedTime;
            } else {
              seekingBlocked = false;
            }
          });
        }
      </script>
      

    

    <!-- Request Plan Section -->
    <div class="container my-5" id="request">
        <h2 id="toggleButton" class="show">طلب عضوية
            <i class="fa fa-arrow-down" id="icon"></i>
        </h2> 
        <!-- Button to toggle the form visibility -->
        
        <!-- Form section initially hidden -->
        <div id="membershipForm" style="display: none;">
            <form method="post">
                {% csrf_token %}
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="name" class="form-label">الاسم *</label>
                        <input type="text" class="form-control" id="name" name="name" required placeholder="ادخل اسمك">
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="email" class="form-label">الايميل </label>
                        <input type="email" class="form-control" id="email" name="email" placeholder="بريدك الالكتروني">
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="phone" class="form-label">السن *</label>
                        <input type="number" class="form-control" id="phone" name="age" required placeholder=" السن ">
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="age" class="form-label">رقم الهاتف *</label>
                        <input type="text" class="form-control" id="age" name="phone" required placeholder="رقم الهاتف" 
                               pattern="\d{11}" title="يرجى إدخال 11 رقمًا" 
                               oninput="validateAge(this)">
                        <div class="invalid-feedback">يرجى إدخال رقم مؤلف من 11 رقمًا.</div>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="gender" class="form-label">النوع</label>
                        <select class="form-select form-control" id="gender" name="gender">
                            <option value="male">ذكر</option>
                            <option value="female">انثي</option>
                        </select>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="location" class="form-label">العنوان *</label>
                        <input type="text" class="form-control" id="location" name="location" required placeholder="العنوان">
                    </div>
                </div>
                <div class="mb-3">
                    <label for="notes" class="form-label">ملاحظات</label>
                    <textarea class="form-control" id="notes" name="notes" rows="3" placeholder="ملاحظاتك"></textarea>
                </div>
                <div class="text-center">
                    <button type="submit" id="requestButton" class="trk-btn trk-btn--border trk-btn--primary d-block mt-4 is-locked"
                    data-lock-message="قم بإكمال الفيديو أولاً من فضلك.">
                    طلب
                    </button>
                </div>
            </form>
        </div>
    </div>
    


 
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        window.validateAge = function(input) {
            const value = input.value;
            const feedback = input.nextElementSibling;

            if (value.length === 11 && /^\d+$/.test(value)) {
                input.setCustomValidity('');
                if (feedback) {
                    feedback.style.display = 'none';
                }
                input.classList.remove('is-invalid');
            } else {
                input.setCustomValidity('Invalid');
                if (feedback) {
                    feedback.style.display = 'block';
                }
                input.classList.add('is-invalid');
            }
        };

        document.addEventListener('DOMContentLoaded', function () {
            const membershipContainer = document.getElementById('membershipForm');
            const toggleButton = document.getElementById('toggleButton');
            const toggleIcon = document.getElementById('icon');

            if (toggleButton && membershipContainer) {
                toggleButton.addEventListener('click', function () {
                    const isHidden = membershipContainer.style.display === 'none' || membershipContainer.style.display === '';
                    membershipContainer.style.display = isHidden ? 'block' : 'none';
                    if (toggleIcon) {
                        toggleIcon.classList.toggle('fa-arrow-down', !isHidden);
                        toggleIcon.classList.toggle('fa-arrow-up', isHidden);
                    }
                });
            }

            const videoElement = document.getElementById('promoVideo');
            const requestButton = document.getElementById('requestButton');
            const videoOverlay = document.getElementById('videoOverlay');
            const overlayButton = document.getElementById('videoOverlayPlay');
            const membershipForm = membershipContainer ? membershipContainer.querySelector('form') : null;
            const lockMessage = requestButton ? requestButton.dataset.lockMessage : '';
            const securityMessage = videoElement ? videoElement.dataset.securityMessage : '';
            const progressKey = videoElement ? (videoElement.dataset.progressKey || null) : null;
            const tolerance = 0.35;
            let internalSeek = false;
            let toastTimeout = null;
            let objectUrl = null;

            const storage = (function () {
                try {
                    const key = 'landing-progress-test';
                    localStorage.setItem(key, '1');
                    localStorage.removeItem(key);
                    return {
                        get: function (name) { return localStorage.getItem(name); },
                        set: function (name, value) { localStorage.setItem(name, value); }
                    };
                } catch (error) {
                    return {
                        get: function () { return null; },
                        set: function () { }
                    };
                }
            })();

            const showNotice = function (message) {
                if (!message) {
                    return;
                }
                let toast = document.getElementById('videoNoticeToast');
                if (!toast) {
                    toast = document.createElement('div');
                    toast.id = 'videoNoticeToast';
                    toast.className = 'video-security-toast';
                    toast.setAttribute('role', 'alert');
                    toast.setAttribute('aria-live', 'assertive');
                    toast.dir = 'auto';
                    document.body.appendChild(toast);
                }
                toast.textContent = message;
                toast.classList.add('show');
                if (toastTimeout) {
                    clearTimeout(toastTimeout);
                }
                toastTimeout = setTimeout(function () {
                    toast.classList.remove('show');
                }, 3200);
            };

            const setButtonLocked = function (locked) {
                if (!requestButton) {
                    return;
                }
                requestButton.dataset.locked = locked ? 'true' : 'false';
                requestButton.classList.toggle('is-locked', locked);
                if (locked) {
                    requestButton.setAttribute('aria-disabled', 'true');
                } else {
                    requestButton.removeAttribute('aria-disabled');
                }
            };

            const handleLockedAction = function (event) {
                if (requestButton && requestButton.dataset.locked === 'true') {
                    event.preventDefault();
                    event.stopPropagation();
                    showNotice(lockMessage);
                }
            };

            if (requestButton) {
                requestButton.addEventListener('click', handleLockedAction, true);
                requestButton.addEventListener('keydown', function (event) {
                    if ((event.key === 'Enter' || event.key === ' ') && requestButton.dataset.locked === 'true') {
                        handleLockedAction(event);
                    }
                });
            }

            if (membershipForm) {
                membershipForm.addEventListener('submit', handleLockedAction);
            }

            if (!videoElement || !videoElement.dataset.videoSrc) {
                setButtonLocked(false);
                return;
            }

            setButtonLocked(true);

            const showOverlay = function () {
                if (videoOverlay) {
                    videoOverlay.classList.add('is-visible');
                }
            };

            const hideOverlay = function () {
                if (videoOverlay) {
                    videoOverlay.classList.remove('is-visible');
                }
            };

            if (overlayButton) {
                overlayButton.addEventListener('click', function () {
                    hideOverlay();
                    videoElement.muted = false;
                    videoElement.play().catch(function () {
                        showOverlay();
                    });
                });
            }

            if ('disableRemotePlayback' in videoElement) {
                videoElement.disableRemotePlayback = true;
            }

            videoElement.addEventListener('contextmenu', function (event) {
                event.preventDefault();
                if (securityMessage) {
                    showNotice(securityMessage);
                }
            });

            videoElement.addEventListener('dragstart', function (event) {
                event.preventDefault();
            });

            let storedData = {};
            if (progressKey) {
                try {
                    storedData = JSON.parse(storage.get(progressKey) || '{}');
                } catch (error) {
                    storedData = {};
                }
            }

            let maxProgress = storedData.maxProgress ? Number(storedData.maxProgress) : 0;
            let videoCompleted = storedData.completed === true;
            let lastPersisted = maxProgress;

            const persistProgress = function () {
                if (!progressKey) {
                    return;
                }
                storage.set(progressKey, JSON.stringify({
                    maxProgress: maxProgress,
                    completed: videoCompleted
                }));
            };

            const clampTime = function (time) {
                if (!videoElement.duration || !isFinite(videoElement.duration)) {
                    return time;
                }
                const maxTime = Math.max(videoElement.duration - tolerance, 0);
                return Math.min(Math.max(time, 0), maxTime);
            };

            const enforcePlaybackPosition = function (target) {
                internalSeek = true;
                videoElement.currentTime = clampTime(target);
            };

            const attemptAutoplay = function () {
                const playPromise = videoElement.play();
                if (playPromise && typeof playPromise.then === 'function') {
                    playPromise.then(hideOverlay).catch(function () {
                        showOverlay();
                    });
                }
            };

            const restoreProgress = function () {
                if (!videoElement.duration || maxProgress <= 0) {
                    if (videoCompleted) {
                        setButtonLocked(false);
                    }
                    attemptAutoplay();
                    return;
                }

                enforcePlaybackPosition(maxProgress);
                if (videoCompleted) {
                    setButtonLocked(false);
                }
                attemptAutoplay();
            };

            if (videoElement.readyState >= 1) {
                restoreProgress();
            } else {
                videoElement.addEventListener('loadedmetadata', restoreProgress, { once: true });
            }

            videoElement.addEventListener('play', function () {
                hideOverlay();
                if (videoElement.currentTime < maxProgress - tolerance) {
                    enforcePlaybackPosition(maxProgress);
                }
            });

            videoElement.addEventListener('seeking', function () {
                if (internalSeek) {
                    return;
                }
                const attemptedTime = videoElement.currentTime;
                if (attemptedTime > maxProgress + tolerance) {
                    enforcePlaybackPosition(maxProgress);
                    showNotice(lockMessage);
                } else if (attemptedTime < maxProgress - tolerance) {
                    enforcePlaybackPosition(maxProgress);
                }
            });

            videoElement.addEventListener('seeked', function () {
                internalSeek = false;
            });

            videoElement.addEventListener('timeupdate', function () {
                if (internalSeek) {
                    return;
                }
                if (videoElement.currentTime > maxProgress) {
                    maxProgress = videoElement.currentTime;
                    if (maxProgress - lastPersisted >= 1) {
                        lastPersisted = maxProgress;
                        persistProgress();
                    }
                }
            });

            videoElement.addEventListener('ratechange', function () {
                if (videoElement.playbackRate !== 1) {
                    videoElement.playbackRate = 1;
                    if (securityMessage) {
                        showNotice(securityMessage);
                    }
                }
            });

            videoElement.addEventListener('ended', function () {
                if (videoElement.duration) {
                    maxProgress = Math.max(maxProgress, videoElement.duration - tolerance);
                }
                videoCompleted = true;
                persistProgress();
                setButtonLocked(false);
                enforcePlaybackPosition(maxProgress);
                videoElement.pause();
            });

            const securityWarning = function () {
                if (securityMessage) {
                    showNotice(securityMessage);
                }
            };

            document.addEventListener('contextmenu', function (event) {
                if (videoElement.contains(event.target)) {
                    event.preventDefault();
                    securityWarning();
                }
            });

            document.addEventListener('keydown', function (event) {
                const key = event.key;
                const target = event.target;

                if (['ArrowLeft', 'ArrowRight', 'Home', 'End'].includes(key) && (target === videoElement || target === document.body)) {
                    event.preventDefault();
                    securityWarning();
                }

                if (key === 'PrintScreen') {
                    event.preventDefault();
                    securityWarning();
                    if (navigator.clipboard && navigator.clipboard.writeText) {
                        navigator.clipboard.writeText('').catch(function () {});
                    }
                }

                if (key === 'F12' || (event.ctrlKey && event.shiftKey && ['I', 'C', 'J'].includes(key.toUpperCase())) || (event.ctrlKey && ['S', 'P', 'U'].includes(key.toUpperCase()))) {
                    event.preventDefault();
                    securityWarning();
                }
            }, true);

            window.addEventListener('beforeunload', function () {
                persistProgress();
                if (objectUrl) {
                    URL.revokeObjectURL(objectUrl);
                }
            });

            const assignSource = function (source) {
                return new Promise(function (resolve) {
                    const handleLoaded = function () {
                        videoElement.removeEventListener('loadeddata', handleLoaded);
                        resolve();
                    };
                    videoElement.addEventListener('loadeddata', handleLoaded);
                    videoElement.src = source;
                    videoElement.load();
                });
            };

            const sourceUrl = videoElement.dataset.videoSrc;
            fetch(sourceUrl, { credentials: 'same-origin' })
                .then(function (response) {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    return response.blob();
                })
                .then(function (blob) {
                    objectUrl = URL.createObjectURL(blob);
                    return assignSource(objectUrl);
                })
                .catch(function () {
                    return assignSource(sourceUrl);
                })
                .finally(function () {
                    if (videoElement.readyState >= 1) {
                        restoreProgress();
                    }
                });
        });
    </script>

    <script>
        function navigateToEnglish() {
            const currentUrl = window.location.href; // Get the current URL
            const newUrl = currentUrl.replace('/ar/', '/'); // Insert 'ar/' in the URL
            window.location.href = newUrl; // Navigate to the new URL
        }
        
    
        </script>
</body>
</html>


{% endblock %}
